<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>PyObservability — Node Monitor</title>
    <meta property="og:type" content="CommandRunner">
    <meta name="keywords" content="Python, Monitor, fastapi, JavaScript, HTML, CSS">
    <meta name="author" content="Vignesh Rao">
    <!-- Favicon.ico and Apple Touch Icon -->
    <link property="og:image" rel="icon" href="https://thevickypedia.github.io/open-source/images/logo/pyninja.ico">
    <link property="og:image" rel="apple-touch-icon"
          href="https://thevickypedia.github.io/open-source/images/logo/pyninja.png">
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <link rel="stylesheet" href="/static/styles.css"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<main class="container">
    <section class="tables-row">
        <div class="panel">
            <div class="panel-header">
                <h3>Registered Endpoints</h3>
            </div>

            <table class="table compact-services-table">
                <thead>
                <tr>
                    <th>Host</th>
                    <th>Name</th>
                    <th>Parent</th>
                    <th>Tags</th>
                    <th>URL</th>
                </tr>
                </thead>
                <tbody>

                {% for host, services in service_map.items() %}
                    {% for svc in services %}
                        <tr>
                            {% if loop.first %}
                                <td rowspan="{{ services | length }}"
                                    style="vertical-align: top; font-weight: 600;">
                                    {{ host }}
                                </td>
                            {% endif %}

                            <td>{{ svc.name }}</td>

                            <td>
                                {% if svc.parent %}
                                    {{ svc.parent }}
                                {% else %}
                                    <span style="opacity: 0.5;">—</span>
                                {% endif %}
                            </td>

                            <td>
                                {% if svc.tag_names %}
                                    {{ svc.tag_names | join(", ") }}
                                {% else %}
                                    <span style="opacity: 0.5;">—</span>
                                {% endif %}
                            </td>

                            <td class="pre">
                                <a href="{{ svc.url }}"
                                   target="_blank"
                                   style="color: var(--accent); text-decoration: none;">
                                    {{ svc.url }}
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                {% endfor %}

                </tbody>
            </table>
        </div>
    </section>

</main>

<footer class="footer">
    <div><code>PyObservability: v{{ version }}</code><br>
        <a href="https://github.com/thevickypedia/PyObservability" target="_blank">https://github.com/thevickypedia/PyObservability</a>
    </div>
</footer>

<script>
    const logoutEndpoint = "{{ logout }}";

    if (!logoutEndpoint.startsWith('/')) {
        document.getElementById("logout").style.display = "none";
    }

    function logout() {
        window.location.href = logoutEndpoint;
    }
</script>
<script src="/static/app.js"></script>
</body>
</html>
